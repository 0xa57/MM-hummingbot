{"version":3,"file":"Modal.js","sources":["../src/Modal/Modal.tsx"],"sourcesContent":["/* eslint-disable @typescript-eslint/ban-ts-ignore */\n/** @jsx jsx */\nimport { jsx, css, ClassNames } from \"@emotion/core\";\nimport React, { useEffect } from \"react\";\nimport { motion } from \"framer-motion\";\nimport * as typography from \"../typography\";\nimport { colors } from \"../colors\";\nimport * as CSS from \"csstype\";\nimport classnames from \"classnames\";\nimport { useSpaceKitProvider } from \"../SpaceKitProvider\";\nimport { assertUnreachable } from \"../shared/assertUnreachable\";\n\ninterface Props {\n  /**\n   * Class name that will be applied to the content `div`, or the component\n   * passed as the `as` prop.\n   */\n  className?: string;\n\n  /**\n   * Override the the default element used to content of the modal\n   *\n   * All props provided will be merged with props that this component adds,\n   * including `className`s being merged. You can use this to make the modal a\n   * `<form>`\n   *\n   * @default `<div />`\n   */\n  as?: React.ReactElement<any, keyof typeof motion>;\n\n  /**\n   * Override the outermost\n   *\n   * All props provided will be merged with props that `Button` adds, including\n   * `className`s being merged.\n   *\n   * @default <button />\n   */\n  containerAs?: React.ReactElement;\n\n  /**\n   * Optional primary action, usually a button\n   *\n   * Do not apply any layout via css; this will be handled internally for consistency\n   */\n  primaryAction?: React.ReactNode;\n\n  /**\n   * Optional secondary action, usually a button\n   *\n   * Do not apply any layout via css; this will be handled internally for consistency\n   */\n  secondaryAction?: React.ReactNode;\n\n  children?: React.ReactNode;\n  /**\n   * Optional description to show of the modal\n   */\n  description?: React.ReactNode;\n\n  /**\n   * Text to display in the bottom left of a modal/dialog\n   */\n  bottomLeftText?: React.ReactNode;\n\n  /**\n   * Callback to call when the modal is closed\n   */\n  onClose?: () => void;\n\n  /**\n   * Size to show the modal at\n   */\n  size: \"small\" | \"medium\" | \"large\";\n\n  /**\n   * Title of the modal\n   */\n  title: React.ReactNode;\n}\n\nconst modalBackdrop = css`\n  position: fixed;\n  display: flex;\n  align-items: center;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n\n  &:after {\n    position: fixed;\n    z-index: 10;\n    content: \"\";\n    background-color: ${colors.grey.lighter};\n    opacity: 0.7;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    z-index: -1;\n    height: 100vh;\n    width: 100vw;\n  }\n`;\n\ntype TLength = string | 0 | number;\n\nfunction getModalWidth(size: Props[\"size\"]): CSS.WidthProperty<TLength> {\n  switch (size) {\n    case \"small\":\n      return 460;\n    case \"medium\":\n      return 600;\n    case \"large\":\n      return 800;\n    /* istanbul ignore next */\n    default:\n      throw assertUnreachable(size);\n  }\n}\n\nexport const Modal: React.FC<Props> = ({\n  as = <div />,\n  className,\n  containerAs = <div />,\n  title,\n  description,\n  children,\n  onClose,\n  size,\n  bottomLeftText,\n  primaryAction,\n  secondaryAction,\n}) => {\n  const { disableAnimations } = useSpaceKitProvider();\n\n  useEffect(() => {\n    function handleKeyDown(event: KeyboardEvent) {\n      if (event.code === \"Escape\" && onClose) {\n        onClose();\n      }\n    }\n\n    // add an event listener for all clicks\n    document.addEventListener(\"keydown\", handleKeyDown);\n\n    return () => document.removeEventListener(\"keydown\", handleKeyDown);\n  }, [onClose]);\n\n  const type: keyof typeof motion = as.type;\n  if (!type || type === \"custom\") {\n    // TypeScript will give us some protection here, but we need to guarantee\n    // that `as` is an element that `motion` supports\n    throw new TypeError(\n      \"`as` must be an element with a corresponding element in `Framer.motion`\"\n    );\n  }\n\n  /**\n   * Framer motion component to render. The type will be taken from the `as`\n   * prop\n   */\n  const MotionComponent = motion[type];\n\n  return (\n    <ClassNames>\n      {({ css, cx }) => {\n        return React.createElement(\n          containerAs.type,\n          {\n            onClick: onClose,\n            ...containerAs.props,\n            className: classnames(\n              containerAs.props.className,\n              cx(css(modalBackdrop))\n            ),\n          },\n          <MotionComponent\n            {...as.props}\n            animate={{ opacity: 1, scale: 1 }}\n            initial={disableAnimations ? false : { opacity: 0, scale: 0.9 }}\n            transition={{\n              scale: {\n                type: \"spring\",\n                stiffness: 150,\n                damping: 200,\n                mass: 0.2,\n                velocity: 8,\n              },\n            }}\n            onClick={\n              // Ignore the type of `event` because the React.MouseEvent\n              // generic will be a union of 170 different DOM elements;\n              // TypeScript can't handle that.\n              //\n              // @ts-ignore\n              (event: React.MouseEvent<any>) => {\n                event.stopPropagation();\n\n                as.props.onClick?.(event);\n              }\n            }\n            className={classnames(\n              className,\n              cx(\n                css({\n                  backgroundColor: \"white\",\n                  borderRadius: 12,\n                  boxShadow: `0 16px 32px 0 rgba(0, 0, 0, 0.12), 0 0 0 1px rgba(18, 21, 26, 0.04)`,\n                  maxHeight: \"80%\",\n                  minWidth: 400,\n                  opacity: 1,\n                  overflowY: \"auto\",\n                  padding: size === \"large\" ? \"40px\" : \"32px\",\n                  position: \"absolute\",\n                  width: getModalWidth(size),\n                  zIndex: 11,\n                  marginLeft: \"auto\",\n                  marginRight: \"auto\",\n                  left: 0,\n                  right: 0,\n                })\n              ),\n              as.props.className,\n              // If the parent component is using emotion with the jsx pragma, we\n              // have to get fancy and intercept the styles to use with the\n              // `ClassNames` wrapper.\n              as.props.css ? css(as.props.css.styles) : null\n            )}\n          >\n            <div>\n              {title && (\n                <div>\n                  <div\n                    css={{\n                      color: colors.black.base,\n                      marginBottom: 10,\n                      ...(size === \"small\"\n                        ? { ...typography.base.large, fontWeight: 600 }\n                        : typography.base.xxlarge),\n                    }}\n                  >\n                    {title}\n                  </div>\n                </div>\n              )}\n              {description && (\n                <div\n                  css={{ ...typography.base.base, color: colors.black.base }}\n                >\n                  {description}\n                </div>\n              )}\n            </div>\n            <div\n              css={{\n                marginTop: size === \"large\" ? 24 : size === \"medium\" ? 16 : 12,\n              }}\n            >\n              {children}\n            </div>\n            {(primaryAction || secondaryAction || bottomLeftText) && (\n              <div\n                css={{\n                  alignItems: \"center\",\n                  display: \"flex\",\n                  justifyContent: \"flex-end\",\n                  marginTop: size === \"medium\" ? 32 : 24,\n                }}\n              >\n                {bottomLeftText && (\n                  <div css={{ marginRight: \"auto\" }}>{bottomLeftText}</div>\n                )}\n                {secondaryAction && (\n                  <div css={{ marginRight: 12 }}>{secondaryAction}</div>\n                )}\n                {primaryAction && <div>{primaryAction}</div>}\n              </div>\n            )}\n          </MotionComponent>\n        );\n      }}\n    </ClassNames>\n  );\n};\n"],"names":["css","colors","assertUnreachable","jsx","useSpaceKitProvider","useEffect","motion","ClassNames","React","typography.base.large","typography.base.xxlarge","typography.base.base"],"mappings":"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"}